<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>40kRoller</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jura">
    <link rel="stylesheet" href="40kroller.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script>
        var lastAccordion = 0;
        $( function() {
          $( "#modbox" ).accordion({
              active: 6,
              collapsible: true,
              heightStyle: 'content',
              animate: {
                easing: 'linear',
                duration: 100
            },
            activate: function (event, ui) {
                var active = $( "#modbox" ).accordion( "option", "active" );
                if (active === false && lastAccordion == 6) {
                    $( "#modbox" ).accordion( "option", "active", 6 );
                } else if (active == 7) {
                    $( "#modbox" ).accordion( "option", "active", 6 );
                } else {
                    lastAccordion = active;
                }
            }
          });
          $( document ).tooltip({
              show: {
                  delay: 1500,
                  duration: 500
              }
          });
        });
    </script>
</head>

<body>
    <h1 id="banner" align="center">40kroller</h1>
    <div id="content">

        <!-- Attacker -->

        <!-- <h2>Attacker's Stats</h2> -->
        <div id="modbox">
            <h3 title="Stats of the attacking and defending units." style="width: 100%;">Statlines</h3>
            <div class="mods">
                <div id="attacker">
                    <div class="statBoxAttacker" id="attackerModels" title="The number of models in the attacking unit.">
                        <label for="attackerModelsbox">Mdls</label><br>
                        <input type="number" name="attackerModelsbox" id="attackerModelsbox" size=2 value=10>
                    </div>
                    <div class="statBoxAttacker" id="attackerA" title="The number of attacks each model can make. [For random attacks, see 'Hit Modifiers' tab]">
                        <label for="attackerAbox">A</label><br>
                        <input type="number" name="attackerAbox" id="attackerAbox" size=1 value=1>
                    </div>
                    <div class="statBoxAttacker" id="attackerAS" title="The WS or BS of the attack (Attack Skill).">
                        <label for="attackerASbox">AS</label><br>
                        <input type="number" name="attackerASbox" id="attackerASbox" size=1 value=3>
                    </div>
                    <div class="statBoxAttacker" id="attackerS" title="The Strength of the model OR weapon used.">
                        <label for="attackerSbox">S</label><br>
                        <input type="number" name="attackerSbox" id="attackerSbox" size=1 value=4>
                    </div>
                    <div class="statBoxAttacker" id="attackerAP" title="The AP (no \'-\' symbol!) of the weapon used.">
                        <label for="attackerAPbox">AP</label><br>
                        <input type="number" name="attackerAPbox" id="attackerAPbox" size=1 value=1>
                    </div>
                </div>

                <!-- Defender -->
                <!-- <h2>Defender's Stats</h2> -->
                <div id="defender">
                    <div class="statBoxDefender" id="defenderModels" title="The number of models in the defending unit.">
                        <label for="defenderModelsbox">Mdls</label><br>
                        <input type="number" name="defenderModelsbox" id="defenderModelsbox" size=2 value=10>
                    </div>
                    <div class="statBoxDefender" id="defenderT" title="The toughness of models in the defending unit.">
                        <label for="defenderTbox">T</label><br>
                        <input type="number" name="defenderTbox" id="defenderTbox" size=1 value=4>
                    </div>
                    <div class="statBoxDefender" id="defenderW" title="The number of Wounds each model in the defending unit has.">
                        <label for="defenderWbox">W</label><br>
                        <input type="number" name="defenderWbox" id="defenderWbox" size=2 value=1>
                    </div>
                    <div class="statBoxDefender" id="defenderSv" title="The Save characteristic of the models in the defending unit.">
                        <label for="defenderSvbox">Sv</label><br>
                        <input type="number" name="defenderSvbox" id="defenderSvbox" size=1 value=3>
                    </div>
                </div>
            </div>
            <!-- Hit Mods -->

            <h3 title="Hit roll modifiers">Hit</h3>
            <div class="mods">
                <div class="mod" title="Add this to the die roll.">
                    <label for="HitMod">Modifier </label>
                    <input type="number" name="HitMod" id="HitMod" size=1 value=0>
                </div>
                <div class="mod" title="Roll xDy+z attacks for each model instead of the flat Attack characteristic.">
                    <input type="checkbox" id="randomAttacks"> Random number of attacks:<br>
                    <input type="number" name="randomAttacksDice" id="randomAttacksDice" size=1 value=1>D
                    <input type="number" name="randomAttacksDenom" id="randomAttacksDenom" size=1 value=6>+
                    <input type="number" name="randomAttacksMod" id="randomAttacksMod" size=1 value=0>
                </div>
                <div class="mod" title="These attacks always hit. Do not roll.">
                    <input type="checkbox" id="flamer"> Auto-hit without rolling
                </div>
                <div class="mod" title="Reroll the hit roll if it\'s lower than this number.">
                    <input type="checkbox" id="rerollhit"> Re-roll
                    <input type="number" name="rerollHITagainst" id="rerollHITagainst" size=1 value=1> or less
                </div>
                <div class="mod" title="Attack again if you roll a 6">
                    <input type="checkbox" id="explode6"> Bonus Attack on 6's
                </div>
                <div class="mod" title="This hit always hits on a 6">
                    <input type="checkbox" id="extrahit6"> Auto-hit on 6's
                </div>
                <div class="mod" title="This hit automatically hits and wounds on a 6">
                    <input type="checkbox" id="autowound6"> Auto-wound on 6's
                </div>
            </div>

            <!-- Wound mods -->

            <h3 title="Wound roll modifiers">Wound</h3>
            <div class="mods">
                <div class="mod" title="Add this to the die roll.">
                    <label for="WMod">Modifier </label>
                    <input type="number" name="WMod" id="WMod" size=1 value=0>
                </div>
                <div class="mod" title="Reroll the wound roll if it\'s lower than this number.">
                    <input type="checkbox" id="rerollwound"> Re-roll
                    <input type="number" name="rerollWDagainst" id="rerollWDagainst" size=1 value=1> or less
                </div>
                <div class="mod" title="Inflict a Mortal Wound on a roll of 6">
                    <input type="checkbox" id="mwo6"> Mortals on 6's
                </div>
                <div class="mod" title="Hit with additional AP on a 6">
                    <input type="checkbox" id="apo6"> Bonus AP on 6's
                    <input type="number" name="apo6amount" id="apo6amount" size=1 value=3>
                </div>
                <div class="mod" title="Ignore all wound rolls at or below this number (like Transhuman Physiology)">
                    Ignore rolls below
                    <input type="number" name="ignorebelowamount" id="ignorebelowamount" size=1 value=0>
                </div>
            </div>

            <!-- Save Mods -->

            <h3 title="Save roll modifiers">Save</h3>
            <div class="mods">
                <div class="mod" title="Add this to the die roll.">
                    <label for="SvMod">Modifier </label>
                    <input type="number" name="SvMod" id="SvMod" size=1 value=0>
                </div>
                <div class="mod" title="Defender as an Invulnerable save.">
                    <input type="checkbox" id="defenderInvChecked"> Invulnerable Save
                    <input type="number" name="defenderInvbox" id="defenderInvbox" size=1 value=7>
                </div>
                <div class="mod" title="Roll a D6 for each point of damage. If it's higher than this number remove that point of damage.">
                    <input type="checkbox" id="defenderFNPChecked"> Feel No Pain
                    <input type="number" name="defenderFNPbox" id="defenderFNPbox" size=1 value=7>
                </div>
            </div>

            <!-- Damage mods -->

            <h3 title="Damage roll modifiers">Damage</h3>
            <div class="mods">

                <div class="mod" title="How many dice do you roll for damage? If 0, then it will always be the Max Damage below.">
                    <label for="attackerDmultibox">Dice</label>
                    <input type="number" name="attackerDmultibox" id="attackerDmultibox" size=1 value=0> (0 for flat damage)
                </div>

                <div class="mod" title="The flat damage (if 0 dice are used) or the maximum sides the damage dice can have.">
                    <label for="attackerDdenombox">Max Damage</label>
                    <input type="number" name="attackerDdenombox" id="attackerDdenombox" size=1 value=1>
                </div>

                <div class="mod" title="Add this to the damage roll">
                    <label for="attackerDmodbox">Modifier</label>
                    <input type="number" name="attackerDmodbox" id="attackerDmodbox" size=1 value=0>
                </div>
                <div class="mod" title="Reduce damage by this much, to a minimum of 1. (Serpent Shield or Disgustingly Resilient)">
                    <label for="flatDRbox">Shield Reduction</label>
                    <input type="number" name="flatDRbox" id="flatDRbox" size=1 value=0>
                </div>
                <div class="mod" title="Model can fight back if killed if they roll this number or higher on a D6.">
                    <input type="checkbox" id="fightback"> Fight on death on
                    <input type="number" name="fightbackagainst" id="fightbackagainst" size=1 value=4>+
                </div>
                <div class="mod" title="When defending models die, attempt to use Reanimation Protocols.">
                    <input type="checkbox" id="reanimate"> Reanimate on
                    <input type="number" name="reanimateagainst" id="reanimateagainst" size=1 value=5>+
                    <!-- re-rolling <input type="number" name="reanimatereroll" id="reanimatereroll" size=1 value=1> or lower -->
                    <!-- adding <input type="number" name="reanimatemod" id="reanimatemod" size=1 value=1> to roll. -->

                </div>
            </div>

            <!-- Buttons -->
            <h3 title="" style="width: 100%;">Setup</h3>

            <div class="mods" style="display: flex; flex-wrap: wrap; justify-content: center;">
                <button type="button" name="button" onclick="setit(1);krunchit();$( '#modbox' ).accordion( 'option', 'active', 6 );" title="Simulate 1 time.">One Fight</button>
                <button type="button" name="button" onclick="setit(100);krunchit();$( '#modbox' ).accordion( 'option', 'active', 6 );" title="Simulate 100 times.">100 Fights</button>
                <button type="button" name="button" onclick="setit(10000);krunchit();$( '#modbox' ).accordion( 'option', 'active', 6 );" title="Simulate 10000 times.">10,000 Fights</button>
            </div>
            <h3 title="Hit roll modifiers" style="width: 100%;" onclick="krunchit();">Outpoot</h3>
            <div id="output">
                <p>
                    40kroller is a tiny, lightweight attack simulator for Warhammer40k.
                </p>
                <b>How to use:</b>
                <ol>
                    <li>Put the attacker's statline in the top boxes.</li>
                    <li>Put the defender's statline in the bottom boxes.</li>
                    <li>Select all of the modifiers for your attacks an defenses in the "Hit", "Wound", "Save", and "Damage" tabs.</li>
                    <li>Use the buttons to roll 1, 1000, or 10000 simulations of this setup.</li>
                    <li>The results will appear in this box.</li>
                    <li>Hover over boxes, tabs, and results with your mouse to get additional info.</li>
                </ol>
                <p>You can get this code for free at: <a href="https://github.com/SuperMechaCow/supermechacow.github.io">https://github.com/SuperMechaCow/supermechacow.github.io</a></p>
                <p>Feel free to host, contribute, and share!</p>
            </div>
            <h3 title="Copy to clipboard to show your buddies on discord and reddit :)" onclick="dumpit();">Copy to Clipboard</h3>


        </div>
    </div>
    <script type="text/javascript" src="40kroller.js">

    </script>
</body>

</html>
